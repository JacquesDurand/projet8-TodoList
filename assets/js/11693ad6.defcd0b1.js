"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[463],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>h});var r=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var s=r.createContext({}),c=function(e){var t=r.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},p=function(e){var t=c(e.components);return r.createElement(s.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,i=e.originalType,s=e.parentName,p=o(e,["components","mdxType","originalType","parentName"]),d=c(n),h=a,m=d["".concat(s,".").concat(h)]||d[h]||u[h]||i;return n?r.createElement(m,l(l({ref:t},p),{},{components:n})):r.createElement(m,l({ref:t},p))}));function h(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=n.length,l=new Array(i);l[0]=d;var o={};for(var s in t)hasOwnProperty.call(t,s)&&(o[s]=t[s]);o.originalType=e,o.mdxType="string"==typeof e?e:a,l[1]=o;for(var c=2;c<i;c++)l[c]=n[c];return r.createElement.apply(null,l)}return r.createElement.apply(null,n)}d.displayName="MDXCreateElement"},7738:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>l,default:()=>u,frontMatter:()=>i,metadata:()=>o,toc:()=>c});var r=n(7462),a=(n(7294),n(3905));const i={sidebar_position:2},l="Files",o={unversionedId:"app/security/files",id:"app/security/files",title:"Files",description:"Symfony's Security Bundle comes well packaged, and for our use cases, there currently aren't",source:"@site/docs/app/security/files.md",sourceDirName:"app/security",slug:"/app/security/files",permalink:"/docs/app/security/files",draft:!1,tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2},sidebar:"DocumentationApp",previous:{title:"Principles",permalink:"/docs/app/security/principles"},next:{title:"Authentication Vs Authorization",permalink:"/docs/app/security/authent_vs_autho"}},s={},c=[{value:"security.yaml",id:"securityyaml",level:2},{value:"password_hashers",id:"password_hashers",level:3},{value:"providers",id:"providers",level:3},{value:"firewalls",id:"firewalls",level:3},{value:"AccessDeniedHandler",id:"accessdeniedhandler",level:2}],p={toc:c};function u(e){let{components:t,...n}=e;return(0,a.kt)("wrapper",(0,r.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"files"},"Files"),(0,a.kt)("p",null,"Symfony's Security Bundle comes well packaged, and for our use cases, there currently aren't\nthat many files that need to be looked at !",(0,a.kt)("br",{parentName:"p"}),"\n","Configuring the bundle is indeed ",(0,a.kt)("em",{parentName:"p"},"almost")," all we need to do !"),(0,a.kt)("h2",{id:"securityyaml"},"security.yaml"),(0,a.kt)("p",null,"Let's take a look at this bundle's configuration file, called ",(0,a.kt)("inlineCode",{parentName:"p"},"security.yaml"),".",(0,a.kt)("br",{parentName:"p"}),"\n","You can find it located at ",(0,a.kt)("inlineCode",{parentName:"p"},"config/packages/security.yaml")," and it looks like that :"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-yaml"},"security:\n\n    enable_authenticator_manager: true\n\n    password_hashers:\n        App\\Entity\\User: bcrypt\n\n    role_hierarchy:\n        ROLE_ADMIN: ROLE_USER\n\n    providers:\n        doctrine:\n            entity:\n                class: App\\Entity\\User\n                property: username\n    firewalls:\n        dev:\n            pattern: ^/(_(profiler|wdt)|css|images|js)/\n            security: false\n        main:\n            access_denied_handler: App\\Security\\AccessDeniedHandler\n            pattern: ^/\n            form_login:\n                login_path: login\n                check_path: login_check\n                always_use_default_target_path:  true\n                default_target_path:  /\n            logout: ~\n\n    access_control:\n        - { path: ^/login, roles: PUBLIC_ACCESS }\n        - { path: ^/users, roles: ROLE_ADMIN }\n        - { path: ^/, roles: ROLE_USER }\n\n")),(0,a.kt)("p",null,"Let us break some of these configuration options down:"),(0,a.kt)("h3",{id:"password_hashers"},"password_hashers"),(0,a.kt)("p",null,"It corresponds to the type of algorithm that will be used to hash the passwords of our users"),(0,a.kt)("h3",{id:"providers"},"providers"),(0,a.kt)("p",null,"Here we are telling our app that the security will be defined around our ",(0,a.kt)("inlineCode",{parentName:"p"},"App\\Entity\\User")," class,\nand that doctrine, our ORM, will be in charge to load (when logging in for instance) our User from the\ndatabase, using its ",(0,a.kt)("inlineCode",{parentName:"p"},"username")," as identifier."),(0,a.kt)("h3",{id:"firewalls"},"firewalls"),(0,a.kt)("p",null,"The firewalls will define which part of our application are secured and how Users will be required to\nauthenticate.",(0,a.kt)("br",{parentName:"p"}),"\n","Only one firewall will be working for each request, depending on how we have defined its"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-yaml"},"pattern:\n")),(0,a.kt)("p",null,"Here, for instance, the ",(0,a.kt)("inlineCode",{parentName:"p"},"dev")," firewall will just make sure we do not block routes generated by Symfony\ndev tools, like the ",(0,a.kt)("a",{parentName:"p",href:"https://symfony.com/doc/current/profiler.html"},"profiler"),", and that anyone in\ndevelopment will be able to access them (These routes will not exist in a production env)."),(0,a.kt)("p",null,"The ",(0,a.kt)("inlineCode",{parentName:"p"},"main")," firewall will take care of all others incoming requests in this case."),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:null},(0,a.kt)("em",{parentName:"th"},"Note"),":")))),(0,a.kt)("p",null,"As mentioned in the ",(0,a.kt)("a",{parentName:"p",href:"https://symfony.com/doc/current/security.html#the-firewall"},"Documentation"),": "),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"Visiting a URL under a firewall doesn't necessarily require you to be authenticated\n(e.g. the login form has to be accessible or some parts of your application are public).")),(0,a.kt)("p",null,"So it does not mean that every route will be blocked ! We will learn a bit more about it\nwhen differentiating between ",(0,a.kt)("strong",{parentName:"p"},"Authorization")," and ",(0,a.kt)("strong",{parentName:"p"},"Authentication")),(0,a.kt)("admonition",{title:"But your left some parts out ?",type:"tip"},(0,a.kt)("p",{parentName:"admonition"},"I intentionally left the ",(0,a.kt)("inlineCode",{parentName:"p"},"role_hierarchy")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"access_control")," out, they will be further explained\nin the next section !")),(0,a.kt)("h2",{id:"accessdeniedhandler"},"AccessDeniedHandler"),(0,a.kt)("p",null,"You may have seen in the ",(0,a.kt)("a",{parentName:"p",href:"#securityyaml"},"security.yaml")," part that we defined a custom\naccess denied handler: "),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-yaml"},"main:\n  access_denied_handler: App\\Security\\AccessDeniedHandler\n")),(0,a.kt)("p",null,"If you take a look at the class, (located in ",(0,a.kt)("inlineCode",{parentName:"p"},"src/Security"),") you will see: "),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-php"},"class AccessDeniedHandler implements AccessDeniedHandlerInterface\n{\n    public function __construct(private readonly UrlGeneratorInterface $router)\n    {\n    }\n\n    /**\n     * {@inheritDoc}\n     */\n    public function handle(Request $request, AccessDeniedException $accessDeniedException): ?Response\n    {\n        return new RedirectResponse($this->router->generate('index'));\n    }\n}\n")),(0,a.kt)("p",null,"This class will be responsible to intercept any AccessDenied Response sent by the firewall to the\napp user and redirect them to the homepage instead of generating a 403 page (which can be confusing)"))}u.isMDXComponent=!0}}]);